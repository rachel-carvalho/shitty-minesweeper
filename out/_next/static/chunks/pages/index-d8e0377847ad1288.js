(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6603:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3315)}])},3315:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var s=n(4111),a=n(1438),r=n(2951),o=n(4924),i=n(8029),l=n(2670),u=n(6042),d=n(828),h=n(9815),c=n(460),p=n(5893),f=n(7294),g=n(9396),v=n(9008),m=n.n(v),b=function(e,t){if(!(0,l.Z)(e,t))throw new Error("Bound instance method accessed before binding")},S=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).calculateTime=r.calculateTime.bind((0,s.Z)(r)),r.handleRestart=r.handleRestart.bind((0,s.Z)(r)),r.state={elapsed:0},r}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){return this.intervalID=setInterval(this.calculateTime,1e3)}},{key:"componentWillUnmount",value:function(){return clearInterval(this.intervalID)}},{key:"calculateTime",value:function(){var e;return b(this,n),this.props.startedAt?(e=(this.props.endedAt||new Date)-this.props.startedAt,this.setState({elapsed:Math.round(e/1e3)})):this.setState({elapsed:0})}},{key:"handleRestart",value:function(){return b(this,n),this.setState({elapsed:0}),this.props.onRestart()}},{key:"render",value:function(){var e,t,n,s,a,r,o,i,l,u,d;return t=(d=this.props).bombs,r=d.foundBombs,a=d.flagging,n=d.dead,u=d.won,e=d.best,o=d.onFlagToggle,i=d.pressing,s=this.state.elapsed,l=t-r,(0,p.jsxs)("div",{id:"toolbar",children:[(0,p.jsx)("span",{id:"bombs",children:l.toString().padStart(t.toString().length,0)}),(0,p.jsx)("button",{onClick:this.handleRestart,children:n?"\ud83d\ude35":u?"\ud83d\ude0e":i?"\ud83d\ude2e":"\ud83d\ude42"}),(0,p.jsx)("button",{onClick:o,children:a?"\ud83d\udea9":"\ud83d\udca3"}),(0,p.jsx)("time",{children:s.toString().padStart(3,0)}),e?(0,p.jsxs)("span",{id:"best",children:["Best: ",e.elapsed]}):void 0]})}}]),n}(f.Component),y=function(e,t){if(!(0,l.Z)(e,t))throw new Error("Bound instance method accessed before binding")},w=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).componentDidUpdate=r.componentDidUpdate.bind((0,s.Z)(r)),r.handleClick=r.handleClick.bind((0,s.Z)(r)),r.handleMouseDown=r.handleMouseDown.bind((0,s.Z)(r)),r.handleMouseUp=r.handleMouseUp.bind((0,s.Z)(r)),r.handleTouchStart=r.handleTouchStart.bind((0,s.Z)(r)),r.handleTouchEnd=r.handleTouchEnd.bind((0,s.Z)(r)),r.handleTouchMove=r.handleTouchMove.bind((0,s.Z)(r)),r.initialState={open:e.opened,flagged:e.flagged,exploded:e.exploded},r.state=r.initialState,r.button=f.createRef(),r}return(0,r.Z)(n,[{key:"componentDidUpdate",value:function(e){if(y(this,n),e.game!==this.props.game)return this.setState(this.initialState)}},{key:"handleClick",value:function(){var e,t,s;if(y(this,n),e=(s=this.props).dead,t=s.flagging,!e&&(!this.flagged()||t))return this.opened()?this.expand():t?this.flag():this.open()}},{key:"expand",value:function(){var e,t,n,s;return n=(s=this.props).row,e=s.column,t=s.neighbors,(0,s.onExpand)(n,e,t)}},{key:"flag",value:function(){var e,t,n,s,a;return a=this.props,s=a.row,e=a.column,t=a.onFlag,n=a.flagged,this.setState((function(a){var r;return r=!(a.flagged||n),t(s,e,r),{flagged:r}}))}},{key:"open",value:function(){var e,t,n,s,a,r;return a=(r=this.props).row,t=r.column,e=r.bomb,n=r.onDeath,s=r.onOpen,this.setState({open:!0}),e?(this.setState({exploded:!0}),n(a,t)):s(a,t)}},{key:"handleMouseDown",value:function(){var e,t,s,a;return y(this,n),s=(a=this.props).row,e=a.column,t=a.opened,(0,a.onPress)(s,e,t||this.state.open)}},{key:"handleMouseUp",value:function(){var e,t,s;return y(this,n),t=(s=this.props).row,e=s.column,(0,s.onUnpress)(t,e)}},{key:"handleTouchStart",value:function(){return y(this,n),this.handleMouseDown()}},{key:"handleTouchEnd",value:function(){return y(this,n),this.handleMouseUp()}},{key:"handleTouchMove",value:function(e){var t,s,a,r,o,i,l,u;return y(this,n),a=(l=e.touches[0]).pageX,r=l.pageY,i=(u=this.button.current.getBoundingClientRect()).top,t=u.bottom,s=u.left,o=u.right,s<a&&a<o&&(i<r&&r<t)?this.handleTouchStart():this.handleTouchEnd()}},{key:"flagged",value:function(){return this.state.flagged||this.props.flagged}},{key:"exploded",value:function(){return this.state.exploded||this.props.exploded}},{key:"opened",value:function(){return this.state.open||this.props.opened}},{key:"render",value:function(){var e,t,n,s,a,r,o;return e=(o=this.props).bomb,s=o.neighbors,n=o.dead,a=o.pressed,r=o.won,t=[],(this.opened()||this.exploded()||n&&e&&!this.flagged())&&t.push("open"),n&&this.flagged()&&!e&&t.push("wrong-flag"),s&&t.push("neighbor"),s&&t.push("neighbor-".concat(s)),a&&t.push("pressed"),(0,p.jsxs)("button",{ref:this.button,disabled:n||r,className:t.join(" "),onClick:this.handleClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseOut:this.handleMouseUp,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onTouchMove:this.handleTouchMove,children:[this.opened()&&s?s:void 0,!this.opened()&&!n||!e||this.exploded()||this.flagged()?void 0:"\ud83d\udca3",this.flagged()?"\ud83d\udea9":void 0,this.exploded()?"\ud83d\udca5":void 0]})}}]),n}(f.Component),k=function(e,t){if(!(0,l.Z)(e,t))throw new Error("Bound instance method accessed before binding")},Z=function(e){(0,i.Z)(o,e);var t=(0,c.Z)(o);function o(e){var n;return(0,a.Z)(this,o),(n=t.call(this,e)).componentDidUpdate=n.componentDidUpdate.bind((0,s.Z)(n)),n.handleOpen=n.handleOpen.bind((0,s.Z)(n)),n.handleFlag=n.handleFlag.bind((0,s.Z)(n)),n.handleDeath=n.handleDeath.bind((0,s.Z)(n)),n.handleExpand=n.handleExpand.bind((0,s.Z)(n)),n.handlePress=n.handlePress.bind((0,s.Z)(n)),n.handleUnpress=n.handleUnpress.bind((0,s.Z)(n)),n.initialState={distributed:!1,bombLocations:[],dead:!1,opened:[],flagged:[],pressed:[],exploded:[],game:null},n.state=n.initialState,n.recentlyOpened=[],n.couldHaveWon=!1,n.loadedState=!1,n.previousBoardBeforeLoad=null,n}return(0,r.Z)(o,[{key:"loadState",value:function(){var e;return e=function(){try{return JSON.parse(this.storage().currentGameBoard)}catch(e){}}.call(this),this.loadedState=!0,(null!=e?e.game:void 0)&&(e.game=new Date(e.game)),this.props.beforeLoad&&(this.previousBoardBeforeLoad=e),this.props.beforeLoad&&(e=null),e}},{key:"componentDidMount",value:function(){return this.restoreState()}},{key:"restoreState",value:function(e){var t;return t=e||this.loadState(),JSON.stringify(null!=t?t.game:void 0)!==JSON.stringify(this.props.game)&&(t=null),this.setState((0,u.Z)({},t||this.initialState))}},{key:"componentDidUpdate",value:function(e){var t,n,s;return k(this,o),e.beforeLoad&&!this.props.beforeLoad?this.restoreState(this.previousBoardBeforeLoad):e.started&&!this.props.started?this.reset():this.firstOpening?(n=(s=(0,d.Z)(this.firstOpening,2))[0],t=s[1],this.firstOpening=null,this.handleOpen(n,t)):(this.cascadeOpening(),this.checkIfWon())}},{key:"reset",value:function(){return this.recentlyOpened=[],this.firstOpening=null,this.couldHaveWon=!1,this.setState(this.initialState)}},{key:"distribute",value:function(e,t){var n,s,a,r,o,i,l;return l=this.props,i=l.rows,r=l.columns,a=l.bombs,n=function(){for(var e=[],t=0;0<=i?t<i:t>i;0<=i?t++:t--)e.push(t);return e}.apply(this).map((function(e){return function(){for(var e=[],t=0;0<=r?t<r:t>r;0<=r?t++:t--)e.push(t);return e}.apply(this).map((function(t){return[e,t]}))})).flat().filter((function(n){var s,a,r;return a=(r=(0,d.Z)(n,2))[0],s=r[1],a<e-1||a>e+1||s<t-1||s>t+1})),s=[],function(){for(var e=[],t=0;0<=a?t<a:t>a;0<=a?t++:t--)e.push(t);return e}.apply(this).forEach((function(){var e;return e=Math.round(Math.random()*(n.length-1)),s.push(n.splice(e,1)[0])})),s.sort((function(e,t){return"".concat(e[0],", ").concat(e[1])-"".concat(t[0],", ").concat(t[1])})),o=new Date,this.setState({distributed:!0,game:o,bombLocations:s}),this.props.onStart(o)}},{key:"bomb",value:function(e,t){return this.state.bombLocations.some((function(n){return n[0]===e&&n[1]===t}))}},{key:"neighbors",value:function(e,t){var n=this;if(!this.bomb(e,t))return this.surrounding(e,t).filter((function(e){return n.bomb.apply(n,(0,h.Z)(e))})).length}},{key:"surrounding",value:function(e,t){var n,s,a,r;return r=this.props,a=r.rows,n=r.columns,function(){for(var t=[],n=s=e-1,a=e+1;s<=a?n<=a:n>=a;s<=a?n++:n--)t.push(n);return t}.apply(this).filter((function(e){return e>=0&&e<a})).map((function(e){var s;return function(){for(var e=[],n=s=t-1,a=t+1;s<=a?n<=a:n>=a;s<=a?n++:n--)e.push(n);return e}.apply(this).filter((function(e){return e>=0&&e<n})).map((function(t){return[e,t]}))})).flat()}},{key:"handleOpen",value:function(e,t){var n=this;return k(this,o),this.state.distributed?this.setState((function(s){var a;if(!s.opened.some((function(n){return n[0]===e&&n[1]===t})))return(a=s.opened.slice(0)).push([e,t]),n.recentlyOpened.push([e,t]),{opened:a}})):(this.distribute(e,t),this.firstOpening=[e,t])}},{key:"cascadeOpening",value:function(){var e,t,n,s,a;for(n=[];(t=this.recentlyOpened.shift())&&t;){var r;if(s=(r=(0,d.Z)(t,2))[0],e=r[1],this.neighbors(s,e))n.push(void 0);else{var o=this;a=this.surrounding(s,e),n.push(a.forEach((function(e){return o.handleOpen.apply(o,(0,h.Z)(e))})))}}return n}},{key:"handleFlag",value:function(e,t,n){var s,a,r;return k(this,o),r=this.props,s=r.onFlagAdded,a=r.onFlagRemoved,this.setState((function(r){var o;return o=r.flagged.slice(0),n?(o.push([e,t]),s(),this.couldHaveWon=!0):(o=o.filter((function(n){return n[0]!==e||n[1]!==t})),a()),{flagged:o}}))}},{key:"handleDeath",value:function(e,t){return k(this,o),this.setState({dead:!0,exploded:[e,t]}),this.props.onDeath()}},{key:"opened",value:function(e,t){return this.state.opened.some((function(n){return n[0]===e&&n[1]===t}))}},{key:"flagged",value:function(e,t){return this.state.flagged.some((function(n){return n[0]===e&&n[1]===t}))}},{key:"pressed",value:function(e,t){return this.state.pressed.some((function(n){return n[0]===e&&n[1]===t}))}},{key:"exploded",value:function(e,t){var n,s,a;return s=(a=(0,d.Z)(this.state.exploded,2))[0],n=a[1],s===e&&n===t}},{key:"unflagged",value:function(e,t){var n,s,a=this;return s=(n=this.surrounding(e,t)).filter((function(e){return!a.flagged.apply(a,(0,h.Z)(e))})),{surrounding:n,unflagged:s}}},{key:"handleExpand",value:function(e,t,n){var s,a,r;if(k(this,o),s=(r=this.unflagged(e,t)).surrounding,(a=r.unflagged).length===s.length-n){var i=this;return a.forEach((function(e){return i.bomb.apply(i,(0,h.Z)(e))?i.handleDeath():(i.handleOpen.apply(i,(0,h.Z)(e)),i.couldHaveWon=!0)}))}}},{key:"handlePress",value:function(e,t,n){var s,a,r=this;return k(this,o),s=[[e,t]],n&&(a=this.unflagged(e,t).unflagged,s=(0,h.Z)(a).concat((0,h.Z)(s))),this.setState((function(n){var a;if(!n.pressed.some((function(n){return n[0]===e&&n[1]===t})))return(a=n.pressed.slice(0)).push.apply(a,s),r.props.onPress(),{pressed:a}}))}},{key:"handleUnpress",value:function(e,t){return k(this,o),this.setState({pressed:[]}),this.props.onUnpress()}},{key:"checkIfWon",value:function(){var e,t;if(!this.props.won&&this.couldHaveWon)return e=this.state.flagged.length===this.props.bombs,t=this.state.opened.length===this.props.rows*this.props.columns-this.props.bombs,e&&t?this.props.onWin():void 0}},{key:"storage",value:function(){return n.g.localStorage||{}}},{key:"render",value:function(){var e,t,n,s,a,r,o,i,l=this;return o=this.props,a=o.rows,e=o.columns,n=o.flagging,r=o.won,i=this.state,t=i.dead,s=i.game,this.loadedState&&(this.storage().currentGameBoard=JSON.stringify(this.state)),(0,p.jsx)("div",{id:"board",children:function(){for(var e=[],t=0;0<=a?t<a:t>a;0<=a?t++:t--)e.push(t);return e}.apply(this).map((function(a){var o=l;return(0,p.jsx)("div",{className:"row",children:function(){for(var t=[],n=0;0<=e?n<e:n>e;0<=e?n++:n--)t.push(n);return t}.apply(l).map((function(e){return(0,p.jsx)(w,{row:a,column:e,flagging:n,bomb:o.bomb(a,e),opened:o.opened(a,e),pressed:o.pressed(a,e),won:r,flagged:o.flagged(a,e),exploded:o.exploded(a,e),dead:t,neighbors:o.neighbors(a,e),game:s,onFlag:o.handleFlag,onOpen:o.handleOpen,onExpand:o.handleExpand,onDeath:o.handleDeath,onPress:o.handlePress,onUnpress:o.handleUnpress},e)}))},a)}))})}}]),o}(f.Component),x=n(1664),C=n.n(x),D=n(1163),j=n.n(D),B=n(3454),A=function(e,t){if(!(0,l.Z)(e,t))throw new Error("Bound instance method accessed before binding")},R=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).handleRowsChange=r.handleRowsChange.bind((0,s.Z)(r)),r.handleColumnsChange=r.handleColumnsChange.bind((0,s.Z)(r)),r.handleBombsChange=r.handleBombsChange.bind((0,s.Z)(r)),r.handleSubmit=r.handleSubmit.bind((0,s.Z)(r)),r.initialState={rows:null,columns:null,bombs:null},r.state=r.initialState,r}return(0,r.Z)(n,[{key:"componentDidUpdate",value:function(e){if(e!==this.props)return this.setState(this.initialState)}},{key:"defaultBombs",value:function(e){var t=e.rows,n=e.columns;return Math.round(t*n*.18)}},{key:"handleRowsChange",value:function(e){return A(this,n),this.setState({rows:e.target.value})}},{key:"handleColumnsChange",value:function(e){return A(this,n),this.setState({columns:e.target.value})}},{key:"handleBombsChange",value:function(e){var t;return A(this,n),t=e.target.value,parseInt(t)===this.defaultBombs(this.currentRowsColumns())&&(t=null),this.setState({bombs:t})}},{key:"handleSubmit",value:function(e){var t,s,a,r,o;return A(this,n),e.preventDefault(),r=(o=this.currentValues()).rows,s=o.columns,t=o.bombs,a="/?rows=".concat(r,"&columns=").concat(s,"&bombs=").concat(t),j().push(a,B.env.BACKEND_URL+a)}},{key:"currentRowsColumns",value:function(){var e,t,n;return t=(n=this.state).rows,e=n.columns,null==t&&(t=this.props.rows),null==e&&(e=this.props.columns),{rows:t,columns:e}}},{key:"calculateBombs",value:function(e,t){return e&&t?this.defaultBombs({rows:e,columns:t}):""}},{key:"currentValues",value:function(){var e,t,n,s;return n=(s=this.currentRowsColumns()).rows,t=s.columns,(e=this.state.bombs)||(e=this.calculateBombs(n,t)),{rows:n,columns:t,bombs:e}}},{key:"render",value:function(){var e,t,n,s,a,r;return n=this.props.onClose,a=(r=this.currentValues()).rows,t=r.columns,e=r.bombs,s="".concat(B.env.BACKEND_URL,"/"),(0,p.jsxs)("section",{id:"settings",children:[(0,p.jsxs)("h1",{children:["Settings",(0,p.jsx)("button",{className:"close",onClick:n,children:"\u2715"})]}),(0,p.jsx)("form",{onSubmit:this.handleSubmit,children:(0,p.jsxs)("fieldset",{children:[(0,p.jsx)("legend",{children:"Board size"}),(0,p.jsxs)("div",{className:"field",children:[(0,p.jsx)("label",{htmlFor:"rows",children:"Rows: "}),(0,p.jsx)("input",{id:"rows",name:"rows",type:"number",value:a,onChange:this.handleRowsChange})]}),(0,p.jsxs)("div",{className:"field",children:[(0,p.jsx)("label",{htmlFor:"columns",children:"Columns: "}),(0,p.jsx)("input",{id:"columns",name:"columns",type:"number",value:t,onChange:this.handleColumnsChange})]}),(0,p.jsxs)("div",{className:"field",children:[(0,p.jsx)("label",{htmlFor:"bombs",children:"Bombs: "}),(0,p.jsx)("input",{id:"bombs",name:"bombs",type:"number",value:e,onChange:this.handleBombsChange})]}),(0,p.jsxs)("div",{className:"actions",children:[(0,p.jsx)(C(),{href:"/",as:s,children:(0,p.jsx)("a",{children:"Use defaults"})}),(0,p.jsx)("button",{children:"Save"})]})]})})]})}}]),n}(f.Component),M=function(e,t){if(!(0,l.Z)(e,t))throw new Error("Bound instance method accessed before binding")},O=function(e){(0,i.Z)(o,e);var t=(0,c.Z)(o);function o(){var e;return(0,a.Z)(this,o),(e=t.call(this)).handleRestart=e.handleRestart.bind((0,s.Z)(e)),e.handleStart=e.handleStart.bind((0,s.Z)(e)),e.handleFlagToggle=e.handleFlagToggle.bind((0,s.Z)(e)),e.handleFlagAdded=e.handleFlagAdded.bind((0,s.Z)(e)),e.handleFlagRemoved=e.handleFlagRemoved.bind((0,s.Z)(e)),e.handleDeath=e.handleDeath.bind((0,s.Z)(e)),e.handleWin=e.handleWin.bind((0,s.Z)(e)),e.handleViewSettingsClick=e.handleViewSettingsClick.bind((0,s.Z)(e)),e.handleCloseSettings=e.handleCloseSettings.bind((0,s.Z)(e)),e.handlePress=e.handlePress.bind((0,s.Z)(e)),e.handleUnpress=e.handleUnpress.bind((0,s.Z)(e)),e.initialState={beforeLoad:!0,started:!1,flagging:!1,foundBombs:0,dead:!1,startedAt:null,endedAt:null,won:!1,best:null,settings:!1,pressing:!1},e.loadedState=!1,e.state=(0,u.Z)({},e.initialState),e}return(0,r.Z)(o,[{key:"loadState",value:function(){var e,t,n,s,a;return n=function(){try{return JSON.parse(this.storage().currentGame)}catch(e){}}.call(this),this.loadedState=!0,(null!=n?n.startedAt:void 0)&&(n.startedAt=new Date(n.startedAt)),(null!=n?n.endedAt:void 0)&&(n.endedAt=new Date(n.endedAt)),s=(a=this.props).rows,t=a.columns,e=a.bombs,!n||n.rows===s&&n.columns===t&&n.bombs===e||(n=null),n||this.initialState}},{key:"componentDidMount",value:function(){return this.setState((0,g.Z)((0,u.Z)({},this.loadState()),{best:this.best(),beforeLoad:!1}))}},{key:"handleRestart",value:function(){return M(this,o),this.resetState(),this.setState((0,g.Z)((0,u.Z)({},this.initialState),{best:this.best()}))}},{key:"handleStart",value:function(e){return M(this,o),this.setState({started:!0,startedAt:e})}},{key:"handleFlagToggle",value:function(){return M(this,o),this.setState((function(e){return{flagging:!e.flagging}}))}},{key:"handleFlagAdded",value:function(){return M(this,o),this.setState((function(e){return{foundBombs:e.foundBombs+1}}))}},{key:"handleFlagRemoved",value:function(){return M(this,o),this.setState((function(e){return{foundBombs:e.foundBombs-1}}))}},{key:"handleDeath",value:function(){return M(this,o),this.setState({dead:!0,endedAt:new Date})}},{key:"storage",value:function(){return n.g.localStorage||{}}},{key:"handleWin",value:function(){var e;return M(this,o),e=new Date,this.saveTime(e),this.setState({won:!0,endedAt:e,best:this.best()})}},{key:"saveTime",value:function(e){var t,n,s,a,r,o,i;return o=(i=this.props).rows,n=i.columns,t=i.bombs,s={startedAt:this.state.startedAt,endedAt:e},(r=this.records())[a="".concat(o,"x").concat(n,"_").concat(t)]||(r[a]=[]),r["".concat(o,"x").concat(n,"_").concat(t)].push(s),this.storage().shittyMinesweeper=JSON.stringify(r)}},{key:"records",value:function(){var e,t,n;if(!this.storage().shittyMinesweeper)return{};for(n in t=JSON.parse(this.storage().shittyMinesweeper))(e=t[n]).forEach((function(e){var t;return e.startedAt=new Date(Date.parse(e.startedAt)),e.endedAt=new Date(Date.parse(e.endedAt)),t=e.endedAt-e.startedAt,e.elapsed=Math.round(t/1e3)})),e.sort((function(e,t){return e.elapsed-t.elapsed}));return t}},{key:"best",value:function(){var e,t,n,s;return n=(s=this.props).rows,t=s.columns,e=s.bombs,(this.records()["".concat(n,"x").concat(t,"_").concat(e)]||[])[0]}},{key:"handleViewSettingsClick",value:function(){return M(this,o),this.handleRestart(),this.setState({settings:!0})}},{key:"handleCloseSettings",value:function(){return M(this,o),this.setState({settings:!1})}},{key:"handlePress",value:function(){return M(this,o),this.setState({pressing:!0})}},{key:"handleUnpress",value:function(){return M(this,o),this.setState({pressing:!1})}},{key:"saveState",value:function(){var e,t,n,s,a,r,o,i,l;if(this.loadedState)return o=this.loadState(),n=(i=this.props).rows,t=i.columns,e=i.bombs,r=(l=o).sRows,a=l.sColumns,s=l.sBombs,!o||!r||n===r&&t===a&&e===s?this.storage().currentGame=JSON.stringify((0,g.Z)((0,u.Z)({},this.state),{rows:n,columns:t,bombs:e})):this.resetState()}},{key:"resetState",value:function(){return this.storage().currentGame=null,this.storage().currentGameBoard=null}},{key:"render",value:function(){var e,t,n,s,a,r,o,i,l,d,h,c,v,b,y,w;return c=(y=this.state).started,v=y.startedAt,r=y.endedAt,o=y.flagging,i=y.foundBombs,a=y.dead,b=y.won,t=y.best,h=y.settings,l=y.pressing,e=y.beforeLoad,d=(w=this.props).rows,s=w.columns,n=w.bombs,this.saveState(),(0,p.jsxs)(f.Fragment,{children:[(0,p.jsxs)(m(),{children:[(0,p.jsx)("title",{children:"Shitty Minesweeper"}),(0,p.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),h?(0,p.jsx)(R,(0,g.Z)((0,u.Z)({},this.props),{onClose:this.handleCloseSettings})):(0,p.jsxs)(f.Fragment,{children:[(0,p.jsx)("button",{id:"view-settings",onClick:this.handleViewSettingsClick,children:"\u2699\ufe0f"}),(0,p.jsx)(S,{bombs:n,foundBombs:i,startedAt:v,endedAt:r,flagging:o,dead:a,won:b,best:t,pressing:l,onRestart:this.handleRestart,onFlagToggle:this.handleFlagToggle}),(0,p.jsx)(Z,{flagging:o,rows:d,columns:s,bombs:n,started:c,won:b,game:v,beforeLoad:e,onStart:this.handleStart,onFlagAdded:this.handleFlagAdded,onFlagRemoved:this.handleFlagRemoved,onPress:this.handlePress,onUnpress:this.handleUnpress,onDeath:this.handleDeath,onWin:this.handleWin})]})]})}}]),o}(f.Component),T=function(e){(0,i.Z)(f,e);var t=(0,c.Z)(f);function f(){var e;return(0,a.Z)(this,f),(e=t.call(this)).handleRouteChangeComplete=e.handleRouteChangeComplete.bind((0,s.Z)(e)),j().events.on("routeChangeComplete",e.handleRouteChangeComplete),e}return(0,r.Z)(f,[{key:"parseSearch",value:function(){var e,t,s,a;return(null!=(s=n.g.location)?s.search:void 0)?(t=location.search.substring(1).split("&").map((function(e){var t,n,s;return t=(s=(0,d.Z)(e.split("="),2))[0],n=s[1],(0,o.Z)({},"".concat(t),n)})),a=(e=Object).assign.apply(e,(0,h.Z)(t)),(0,u.Z)({},this.props,a)):this.props}},{key:"handleRouteChangeComplete",value:function(e){return function(e,t){if(!(0,l.Z)(e,t))throw new Error("Bound instance method accessed before binding")}(this,f),this.setState(this.parseSearch())}},{key:"render",value:function(){var e,t,n,s,a;return s=(a=this.state||this.parseSearch()).rows,t=a.columns,e=(n=a.bombs)?parseInt(n):Math.round(t*s*.18),(0,p.jsx)(O,{rows:s,columns:t,bombs:e})}}],[{key:"getInitialProps",value:function(e){var t=e.query;e.req;return{rows:(null!=t?t.rows:void 0)||15,columns:(null!=t?t.columns:void 0)||10,bombs:null!=t?t.bombs:void 0}}}]),f}(f.Component)}},function(e){e.O(0,[144,774,888,179],(function(){return t=6603,e(e.s=t);var t}));var t=e.O();_N_E=t}]);